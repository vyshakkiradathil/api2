"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[5199],{19150:function(M,n,e){e.d(n,{R:function(){return o}});var t=e(69262),a=e(33348),r=e(20108);function o(l={},i={}){const{id:s="",...d}=l,c=(0,a.stringify)(d,{encode:!1}),{get:u}=(0,t.kY)(),{data:E,isError:O,isLoading:T,refetch:D}=(0,r.useQuery)(["users",s,d],async()=>{const{data:{data:h}}=await u(`/admin/users/${s}${c?`?${c}`:""}`);return h},i);let p=[];return s&&E?p=[E]:Array.isArray(E?.results)&&(p=E.results),{users:p,pagination:E?.pagination??null,isLoading:T,isError:O,refetch:D}}},83119:function(M,n){const e=()=>null;n.Z=e},83196:function(M,n,e){var t=e(32735),a=e(72850),r=e(41415),o=e(69262),l=e(5644),i=e(60216),s=e.n(i),d=e(67879);const c=({displayedFilters:u})=>{const[E,O]=(0,t.useState)(!1),{formatMessage:T}=(0,d.Z)(),D=(0,t.useRef)(),p=()=>{O(h=>!h)};return t.createElement(t.Fragment,null,t.createElement(a.x,{paddingTop:1,paddingBottom:1},t.createElement(r.z,{variant:"tertiary",ref:D,startIcon:t.createElement(l.Z,null),onClick:p,size:"S"},T({id:"app.utils.filters",defaultMessage:"Filters"})),E&&t.createElement(o.J5,{displayedFilters:u,isVisible:E,onToggle:p,source:D})),t.createElement(o.W$,{filtersSchema:u}))};c.propTypes={displayedFilters:s().arrayOf(s().shape({name:s().string.isRequired,metadatas:s().shape({label:s().string}),fieldSchema:s().shape({type:s().string})})).isRequired},n.Z=c},9814:function(M,n,e){var t=e(32735),a=e(41415),r=e(7961),o=e(60216),l=e.n(o),i=e(67879);const s=({onClick:d})=>{const{formatMessage:c}=(0,i.Z)();return t.createElement(a.z,{onClick:d,startIcon:t.createElement(r.Z,null),size:"S"},c({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}))};s.propTypes={onClick:l().func.isRequired},n.Z=s},60509:function(M,n){const e={firstname:"",lastname:"",email:"",roles:[]};n.Z=e},61358:function(M,n){const e=[];n.Z=e},10108:function(M,n,e){e.r(n),e.d(n,{default:function(){return Ze}});var t=e(32735),a=e(69262),r=e(83983),o=e(27649),l=e(82055),i=e(99223),s=e(17e3),d=e(33348),c=e.n(d),u=e(67879),E=e(20108),O=e(53038),T=e(19150),D=e(83196),p=e(35658),h=e(94547),L=e(19786),V=e(82884),I=e(49372),b=e(87933),q=e(50563),y=e(72850),ae=e(68625),se=e(4038),ne=e(60216),g=e.n(ne),Y=e(8997);const C=({canDelete:f,headers:U,entriesToDelete:A,onClickDelete:F,onSelectRow:G,withMainAction:B,withBulkActions:_,rows:z})=>{const{push:j,location:{pathname:v}}=(0,O.k6)(),{formatMessage:Z}=(0,u.Z)();return t.createElement(p.p,null,z.map(m=>{const W=A.findIndex(K=>K===m.id)!==-1;return t.createElement(h.Tr,{key:m.id,...(0,a.X7)({fn:()=>j(`${v}/${m.id}`),condition:_})},B&&t.createElement(L.Td,{...a.UW},t.createElement(V.C,{"aria-label":Z({id:"app.component.table.select.one-entry",defaultMessage:"Select {target}"},{target:(0,Y.Pp)(m.firstname,m.lastname)}),checked:W,onChange:()=>{G({name:m.id,value:!W})}})),U.map(({key:K,cellFormatter:$,name:x,...N})=>t.createElement(L.Td,{key:K},typeof $=="function"?$(m,{key:K,name:x,formatMessage:Z,...N}):t.createElement(I.Z,{textColor:"neutral800"},m[x]||"-"))),_&&t.createElement(L.Td,null,t.createElement(b.k,{justifyContent:"end"},t.createElement(q.h,{onClick:()=>j(`${v}/${m.id}`),label:Z({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:(0,Y.Pp)(m.firstname,m.lastname)}),noBorder:!0,icon:t.createElement(ae.Z,null)}),f&&t.createElement(y.x,{paddingLeft:1,...a.UW},t.createElement(q.h,{onClick:()=>F(m.id),label:Z({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:(0,Y.Pp)(m.firstname,m.lastname)}),noBorder:!0,icon:t.createElement(se.Z,null)})))))}))};C.defaultProps={canDelete:!1,entriesToDelete:[],onClickDelete(){},onSelectRow(){},rows:[],withBulkActions:!1,withMainAction:!1},C.propTypes={canDelete:g().bool,entriesToDelete:g().array,headers:g().array.isRequired,onClickDelete:g().func,onSelectRow:g().func,rows:g().array,withBulkActions:g().bool,withMainAction:g().bool};var ue=C,ee=e(20011),re=e(41415),Ee=e(85025),ge=e(55225),pe=e(31600),de=e(15335),oe=e(5803),Me=e(11406),fe=e(26858),ve=e(51654),Pe=e(92802),De=e(4397),he=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0}]],J=e(24346),Oe=J.Ry().shape({firstname:J.Z_().trim().required(a.I0.required),lastname:J.Z_(),email:J.Z_().email(a.I0.email).required(a.I0.required),roles:J.IX().min(1,a.I0.required).required(a.I0.required)}),ye={create:{buttonSubmitLabel:{id:"app.containers.Users.ModalForm.footer.button-success",defaultMessage:"Invite user"},isDisabled:!1,next:"magic-link"},"magic-link":{buttonSubmitLabel:{id:"global.finish",defaultMessage:"Finish"},isDisabled:!0,next:null}};const Ce=(()=>window&&window.strapi&&window.strapi.isEE?e(28890).Z:e(16325).Z)(),_e=(()=>window&&window.strapi&&window.strapi.isEE?e(64746).Z:e(60509).Z)(),Te=(()=>window&&window.strapi&&window.strapi.isEE?e(43116).Z:e(61358).Z)(),ce=f=>{let{onSuccess:U,onToggle:A}=f;const[F,G]=(0,t.useState)("create"),[B,_]=(0,t.useState)(!1),[z,j]=(0,t.useState)(null),{formatMessage:v}=(0,u.Z)(),Z=(0,a.lm)(),{lockApp:m,unlockApp:W}=(0,a.o1)(),{post:K}=(0,a.kY)(),$=(0,E.useMutation)(S=>K("/admin/users",S),{async onSuccess(S){let{data:Q}=S;j(Q.data.registrationToken),await U(),te(),_(!1)},onError(S){throw _(!1),Z({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),S},onSettled(){W()}}),x=v({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}),N=async(S,Q)=>{let{setErrors:k}=Q;m(),_(!0);try{await $.mutateAsync(S)}catch(w){W(),w?.response?.data?.error.message==="Email already taken"&&k({email:w.response.data.error.message})}},te=()=>{P?G(P):A()},{buttonSubmitLabel:X,isDisabled:H,next:P}=ye[F],We=F==="create"?t.createElement(re.z,{type:"submit",loading:B},v(X)):t.createElement(re.z,{type:"button",loading:B,onClick:A},v(X));return t.createElement(Ee.P,{onClose:A,labelledBy:"title"},t.createElement(ge.x,null,t.createElement(fe.O,{label:x},t.createElement(ve.$,{isCurrent:!0},x))),t.createElement(Pe.J9,{initialValues:_e,onSubmit:N,validationSchema:Oe,validateOnChange:!1},S=>{let{errors:Q,handleChange:k,values:w}=S;return t.createElement(a.l0,null,t.createElement(pe.f,null,t.createElement(b.k,{direction:"column",alignItems:"stretch",gap:6},F!=="create"&&t.createElement(Ce,{registrationToken:z}),t.createElement(y.x,null,t.createElement(I.Z,{variant:"beta",as:"h2"},v({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"User details"})),t.createElement(y.x,{paddingTop:4},t.createElement(b.k,{direction:"column",alignItems:"stretch",gap:1},t.createElement(de.r,{gap:5},he.map(ie=>ie.map(R=>t.createElement(oe.P,(0,ee.Z)({key:R.name},R.size),t.createElement(a.jm,(0,ee.Z)({},R,{disabled:H,error:Q[R.name],onChange:k,value:w[R.name]}))))))))),t.createElement(y.x,null,t.createElement(I.Z,{variant:"beta",as:"h2"},v({id:"global.roles",defaultMessage:"User's role"})),t.createElement(y.x,{paddingTop:4},t.createElement(de.r,{gap:5},t.createElement(oe.P,{col:6,xs:12},t.createElement(De.Z,{disabled:H,error:Q.roles,onChange:k,value:w.roles})),Te.map(ie=>ie.map(R=>t.createElement(oe.P,(0,ee.Z)({key:R.name},R.size),t.createElement(a.jm,(0,ee.Z)({},R,{disabled:H,onChange:k,value:w[R.name]})))))))))),t.createElement(Me.m,{startActions:t.createElement(re.z,{variant:"tertiary",onClick:A,type:"button"},v({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:We}))}))};ce.propTypes={onToggle:g().func.isRequired,onSuccess:g().func.isRequired};var Le=ce;const le=({pagination:f})=>t.createElement(y.x,{paddingTop:4},t.createElement(b.k,{alignItems:"flex-end",justifyContent:"space-between"},t.createElement(a.v4,null),t.createElement(a.tU,{pagination:f})));le.defaultProps={pagination:{pageCount:0,pageSize:10,total:0}},le.propTypes={pagination:g().shape({page:g().number,pageCount:g().number,pageSize:g().number,total:g().number})};var Ae=le,Ie=[{name:"firstname",metadatas:{label:"Firstname"},fieldSchema:{type:"string"}},{name:"lastname",metadatas:{label:"Lastname"},fieldSchema:{type:"string"}},{name:"email",metadatas:{label:"Email"},fieldSchema:{type:"email"}},{name:"username",metadatas:{label:"Username"},fieldSchema:{type:"string"}},{name:"isActive",metadatas:{label:"Active user"},fieldSchema:{type:"boolean"}}],Re=[{name:"firstname",key:"firstname",metadatas:{label:{id:"Settings.permissions.users.firstname",defaultMessage:"Firstname"},sortable:!0}},{name:"lastname",key:"lastname",metadatas:{label:{id:"Settings.permissions.users.lastname",defaultMessage:"Lastname"},sortable:!0}},{key:"email",name:"email",metadatas:{label:{id:"Settings.permissions.users.email",defaultMessage:"Email"},sortable:!0}},{key:"roles",name:"roles",metadatas:{label:{id:"Settings.permissions.users.roles",defaultMessage:"Roles"},sortable:!1},cellFormatter({roles:f},{formatMessage:U}){return t.createElement(I.Z,{textColor:"neutral800"},f.map(A=>U({id:`Settings.permissions.users.${A.code}`,defaultMessage:A.name})).join(`,
`))}},{key:"username",name:"username",metadatas:{label:{id:"Settings.permissions.users.username",defaultMessage:"Username"},sortable:!0}},{key:"isActive",name:"isActive",metadatas:{label:{id:"Settings.permissions.users.user-status",defaultMessage:"User status"},sortable:!1},cellFormatter({isActive:f},{formatMessage:U}){return t.createElement(b.k,null,t.createElement(a.qb,{isActive:f,variant:f?"success":"danger"}),t.createElement(I.Z,{textColor:"neutral800"},U({id:f?"Settings.permissions.users.active":"Settings.permissions.users.inactive",defaultMessage:f?"Active":"Inactive"})))}}];const Ue=(()=>window&&window.strapi&&window.strapi.isEE?e(21306).Z:e(83119).Z)(),Se=(()=>window&&window.strapi&&window.strapi.isEE?e(99724).Z:e(9814).Z)(),me=["ee","license-limit-info"];var Be=()=>{const{post:f}=(0,a.kY)(),{formatAPIError:U}=(0,a.So)(),[A,F]=(0,t.useState)(!1),{allowedActions:{canCreate:G,canDelete:B,canRead:_}}=(0,a.ss)(r.Z.settings.users),z=(0,E.useQueryClient)(),j=(0,a.lm)(),{formatMessage:v}=(0,u.Z)(),{search:Z}=(0,O.TH)();(0,a.go)(),Ue();const{users:m,pagination:W,isError:K,isLoading:$,refetch:x}=(0,T.R)(c().parse(Z,{ignoreQueryPrefix:!0}),{enabled:_}),N=Re.map(P=>({...P,metadatas:{...P.metadatas,label:v(P.metadatas.label)}})),te=v({id:"global.users",defaultMessage:"Users"}),X=()=>{F(P=>!P)},H=(0,E.useMutation)(async P=>{await f("/admin/users/batch-delete",{ids:P})},{async onSuccess(){await x(),await z.refetchQueries(me)},onError(P){j({type:"warning",message:{id:"notification.error",message:U(P),defaultMessage:"An error occured"}})}});return t.createElement(o.o,{"aria-busy":$},t.createElement(a.SL,{name:"Users"}),t.createElement(l.T,{primaryAction:G&&t.createElement(Se,{onClick:X}),title:te,subtitle:v({id:"Settings.permissions.users.listview.header.subtitle",defaultMessage:"All the users who have access to the Strapi admin panel"})}),_&&t.createElement(i.Z,{startActions:t.createElement(t.Fragment,null,t.createElement(a.m,{label:v({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:te})}),t.createElement(D.Z,{displayedFilters:Ie}))}),t.createElement(s.D,{canRead:_},!_&&t.createElement(a.ZF,null),K&&t.createElement("div",null,"TODO: An error occurred"),_&&t.createElement(t.Fragment,null,t.createElement(a.tM,{contentType:"Users",isLoading:$,onConfirmDeleteAll:H.mutateAsync,onConfirmDelete:P=>H.mutateAsync([P]),headers:N,rows:m,withBulkActions:!0,withMainAction:B},t.createElement(ue,{canDelete:B,headers:N,rows:m,withBulkActions:!0,withMainAction:B})),W&&t.createElement(Ae,{pagination:W}))),A&&t.createElement(Le,{onSuccess:async()=>{await x(),await z.refetchQueries(me)},onToggle:X}))},Ze=()=>t.createElement(a.O4,{permissions:r.Z.settings.users.main},t.createElement(Be,null))},76779:function(M,n,e){var t=e(32735),a=e(50563),r=e(69262),o=e(47765),l=e(60216),i=e.n(l),s=e(67879);const d=({children:c,target:u})=>{const E=(0,r.lm)(),{formatMessage:O}=(0,s.Z)(),{copy:T}=(0,r.VP)(),D=O({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),p=async()=>{await T(u)&&E({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(r.Y_,{endAction:t.createElement(a.h,{label:D,noBorder:!0,icon:t.createElement(o.Z,null),onClick:p}),title:u,titleEllipsis:!0,subtitle:c,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};d.propTypes={children:i().oneOfType([i().element,i().string]).isRequired,target:i().string.isRequired},n.Z=d},16325:function(M,n,e){var t=e(32735),a=e(60216),r=e.n(a),o=e(67879),l=e(78246),i=e(76779);const s=({registrationToken:d})=>{const{formatMessage:c}=(0,o.Z)(),u=`${window.location.origin}${l.Z}auth/register?registrationToken=${d}`;return t.createElement(i.Z,{target:u},c({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:r().string},n.Z=s},4397:function(M,n,e){var t=e(32735),a=e(68465),r=e(84967),o=e(69262),l=e(27169),i=e(60216),s=e.n(i),d=e(67879),c=e(20108),u=e(8471);const E=u.F4`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,O=u.ZP.div`
  animation: ${E} 2s infinite linear;
`,T=()=>t.createElement(O,null,t.createElement(l.Z,null)),D=async()=>{const{get:h}=(0,o.tg)(),{data:L}=await h("/admin/roles");return L.data},p=({disabled:h,error:L,onChange:V,value:I})=>{const{status:b,data:q}=(0,c.useQuery)(["roles"],D,{staleTime:5e4}),{formatMessage:y}=(0,d.Z)(),ae=L?y({id:L,defaultMessage:L}):"",se=y({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),ne=y({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),g=y({id:"app.components.Select.placeholder",defaultMessage:"Select"}),Y=b==="loading"?t.createElement(T,null):void 0;return t.createElement(a.P,{id:"roles",disabled:h,error:ae,hint:ne,label:se,name:"roles",onChange:C=>{V({target:{name:"roles",value:C}})},placeholder:g,multi:!0,startIcon:Y,value:I.map(C=>C.toString()),withTags:!0,required:!0},(q||[]).map(C=>t.createElement(r.W,{key:C.id,value:C.id.toString()},y({id:`global.${C.code}`,defaultMessage:C.name}))))};p.defaultProps={disabled:!1,error:void 0},p.propTypes={disabled:s().bool,error:s().string,onChange:s().func.isRequired,value:s().array.isRequired},n.Z=p},99724:function(M,n,e){var t=e(32735),a=e(87933),r=e(63919),o=e(99140),l=e(41415),i=e(69932),s=e(7961),d=e(36866),c=e.n(d),u=e(60216),E=e.n(u),O=e(67879),T=e(58414);const D=({onClick:p})=>{const{formatMessage:h}=(0,O.Z)(),{license:L}=(0,T.q5)(),{permittedSeats:V,shouldStopCreate:I}=L?.data??{};return t.createElement(a.k,{gap:2},!c()(V)&&I&&t.createElement(r.u,{description:h({id:"Settings.application.admin-seats.at-limit-tooltip",defaultMessage:"At limit: add seats to invite more users"}),position:"left"},t.createElement(o.J,{width:`${14/16}rem`,height:`${14/16}rem`,color:"danger500",as:i.Z})),t.createElement(l.z,{"data-testid":"create-user-button",onClick:p,startIcon:t.createElement(s.Z,null),size:"S",disabled:I},h({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"})))};D.propTypes={onClick:E().func.isRequired},n.Z=D},64746:function(M,n,e){var t=e(60509);const a=window.strapi.features.isEnabled(window.strapi.features.SSO)?{useSSORegistration:!0}:{},r={...t.Z,...a};n.Z=r},43116:function(M,n){const e=window.strapi.features.isEnabled(window.strapi.features.SSO)?[[{intlLabel:{id:"Settings.permissions.users.form.sso",defaultMessage:"Connect with SSO"},hint:{id:"Settings.permissions.users.form.sso.description",defaultMessage:"When enabled (ON), users can login via SSO"},name:"useSSORegistration",type:"bool",size:{col:6,xs:12}}]]:[];n.Z=e},28890:function(M,n,e){var t=e(32735),a=e(60216),r=e.n(a),o=e(67879),l=e(78246),i=e(76779);const s=({registrationToken:d})=>{const{formatMessage:c}=(0,o.Z)();return d?t.createElement(i.Z,{target:`${window.location.origin}${l.Z}auth/register?registrationToken=${d}`},c({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(i.Z,{target:`${window.location.origin}${l.Z}auth/login`},c({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:r().string},n.Z=s},99223:function(M,n,e){e.d(n,{Z:function(){return r}});var t=e(74512),a=e(87933);const r=({startActions:o,endActions:l})=>!o&&!l?null:(0,t.jsxs)(a.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,t.jsx)(a.k,{gap:2,wrap:"wrap",children:o}),(0,t.jsx)(a.k,{gap:2,shrink:0,wrap:"wrap",children:l})]})},7961:function(M,n,e){e.d(n,{Z:function(){return r}});var t=e(74512);const a=o=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...o,children:[(0,t.jsx)("path",{fill:"#32324D",d:"M0 2.8A.8.8 0 0 1 .8 2h22.4a.8.8 0 0 1 .8.8v2.71a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V2.8Z"}),(0,t.jsx)("path",{fill:"#32324D",d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873ZM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053Z"}),(0,t.jsx)("path",{fill:"#32324D",d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555Z"})]}),r=a}}]);
