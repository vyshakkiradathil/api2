"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[9600],{81450:function(H,h,t){t.d(h,{Z:function(){return B}});var e=t(32735),r=t(35658),R=t(94547),y=t(19786),C=t(49372),V=t(87933),l=t(69262),M=t(60216),n=t.n(M),b=t(53038),O=t(72850),S=t(50563),x=t(4038),E=t(67879);const N=({tokenName:s,onClickDelete:c,tokenType:m})=>{const{formatMessage:k}=(0,E.Z)(),{trackUsage:f}=(0,l.rS)(),[g,i]=(0,e.useState)(!1),T=()=>{i(!1),f("willDeleteToken",{tokenType:m}),c()};return e.createElement(O.x,{paddingLeft:1,onClick:p=>p.stopPropagation()},e.createElement(S.h,{onClick:()=>{i(!0)},label:k({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${s}`}),name:"delete",noBorder:!0,icon:e.createElement(x.Z,null)}),e.createElement(l.QH,{onToggleDialog:()=>i(!1),onConfirm:T,isOpen:g}))};N.propTypes={tokenName:n().string.isRequired,onClickDelete:n().func.isRequired,tokenType:n().string.isRequired};var K=N,F=t(54894),j=t(8471);const $={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},W=(0,j.ZP)(l.rU)`
  svg {
    path {
      fill: ${({theme:s})=>s.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:s})=>s.colors.neutral800};
      }
    }
  }
`,A=({tokenName:s,tokenId:c,buttonType:m,children:k})=>{const{formatMessage:f}=(0,E.Z)(),{location:{pathname:g}}=(0,b.k6)();return e.createElement(W,{to:`${g}/${c}`,title:f($[m],{target:s})},k)};A.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired,buttonType:n().string,children:n().node.isRequired},A.defaultProps={buttonType:"edit"};var Z=A;const u=({tokenName:s,tokenId:c})=>e.createElement(Z,{tokenName:s,tokenId:c,buttonType:"read"},e.createElement(F.Z,null));u.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired};var v=u,L=t(68625);const I=({tokenName:s,tokenId:c})=>e.createElement(Z,{tokenName:s,tokenId:c},e.createElement(L.Z,null));I.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired};var Q=I;const d=({permissions:s,headers:c,contentType:m,isLoading:k,tokens:f,onConfirmDelete:g,tokenType:i})=>{const{canDelete:T,canUpdate:p,canRead:D}=s,U=T||p||D,[{query:P}]=(0,l.Kx)(),[,Y]=P?P.sort.split(":"):"ASC",{push:w,location:{pathname:a}}=(0,b.k6)(),{trackUsage:J}=(0,l.rS)(),G=f.sort((o,X)=>{const z=o.name.localeCompare(X.name);return Y==="DESC"?-z:z});return e.createElement(l.tM,{headers:c,contentType:m,rows:f,withBulkActions:U,isLoading:k,onConfirmDelete:g},e.createElement(r.p,null,G.map(o=>e.createElement(R.Tr,{key:o.id,...(0,l.X7)({fn(){J("willEditTokenFromList",{tokenType:i}),w(`${a}/${o.id}`)},condition:p})},e.createElement(y.Td,{maxWidth:(0,l.Q1)(250)},e.createElement(C.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0},o.name)),e.createElement(y.Td,{maxWidth:(0,l.Q1)(250)},e.createElement(C.Z,{textColor:"neutral800",ellipsis:!0},o.description)),e.createElement(y.Td,null,e.createElement(C.Z,{textColor:"neutral800"},e.createElement(l.ij,{timestamp:new Date(o.createdAt)}))),e.createElement(y.Td,null,o.lastUsedAt&&e.createElement(C.Z,{textColor:"neutral800"},e.createElement(l.ij,{timestamp:new Date(o.lastUsedAt)}))),U&&e.createElement(y.Td,null,e.createElement(V.k,{justifyContent:"end"},p&&e.createElement(Q,{tokenName:o.name,tokenId:o.id}),!p&&D&&e.createElement(v,{tokenName:o.name,tokenId:o.id}),T&&e.createElement(K,{tokenName:o.name,onClickDelete:()=>g(o.id),tokenType:i})))))))};d.propTypes={tokens:n().array,permissions:n().shape({canRead:n().bool,canDelete:n().bool,canUpdate:n().bool}).isRequired,headers:n().arrayOf(n().shape({cellFormatter:n().func,key:n().string.isRequired,metadatas:n().shape({label:n().string.isRequired,sortable:n().bool}).isRequired,name:n().string.isRequired})),contentType:n().string.isRequired,isLoading:n().bool,onConfirmDelete:n().func,tokenType:n().string.isRequired},d.defaultProps={tokens:[],headers:[],isLoading:!1,onConfirmDelete(){}};var B=d},68774:function(H,h,t){t.d(h,{Z:function(){return e},f:function(){return r}});const e="api-token",r="transfer-token"},38286:function(H,h,t){t.r(h),t.d(h,{default:function(){return A}});var e=t(32735),r=t(69262),R=t(83983),y=t(27649),C=t(82055),V=t(17e3),l=t(41415),M=t(19406),n=t(33348),b=t.n(n),O=t(67879),S=t(20108),x=t(53038),E=t(68774),N=t(81450),F=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],$=()=>{(0,r.go)();const Z=(0,S.useQueryClient)(),{formatMessage:u}=(0,O.Z)(),v=(0,r.lm)(),{allowedActions:{canCreate:L,canDelete:I,canUpdate:Q,canRead:d}}=(0,r.ss)(R.Z.settings["transfer-tokens"]),{push:B}=(0,x.k6)(),{trackUsage:s}=(0,r.rS)(),{startSection:c}=(0,r.c1)(),m=(0,e.useRef)(c),{get:k,del:f}=(0,r.kY)();(0,e.useEffect)(()=>{m.current&&m.current("transferTokens")},[]),(0,e.useEffect)(()=>{B({search:b().stringify({sort:"name:ASC"},{encode:!1})})},[B]);const g=F.map(a=>({...a,metadatas:{...a.metadatas,label:u(a.metadatas.label)}})),{data:i,status:T,isFetching:p}=(0,S.useQuery)(["transfer-tokens"],async()=>{s("willAccessTokenList",{tokenType:E.f});const{data:{data:a}}=await k("/admin/transfer/tokens");return s("didAccessTokenList",{number:a.length,tokenType:E.f}),a},{enabled:d,onError(a){console.log("error",a),a?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?v({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),D=d&&(T!=="success"&&T!=="error"||T==="success"&&p),U=(0,S.useMutation)(async a=>{await f(`/admin/transfer/tokens/${a}`)},{async onSuccess(){await Z.invalidateQueries(["transfer-tokens"])},onError(a){a?.response?.data?.data?v({type:"warning",message:a.response.data.data}):a?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?v({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),P=d&&i,Y=d&&!i&&!L,w=d&&!i&&L;return e.createElement(y.o,{"aria-busy":D},e.createElement(r.SL,{name:"Transfer Tokens"}),e.createElement(C.T,{title:u({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:u({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:L?e.createElement(r.Qj,{"data-testid":"create-transfer-token-button",startIcon:e.createElement(M.Z,null),size:"S",onClick:()=>s("willAddTokenFromList",{tokenType:E.f}),to:"/settings/transfer-tokens/create"},u({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})):void 0}),e.createElement(V.D,null,!d&&e.createElement(r.ZF,null),P&&e.createElement(N.Z,{permissions:{canRead:d,canDelete:I,canUpdate:Q},headers:g,contentType:"trasfer-tokens",rows:i,isLoading:D,onConfirmDelete:a=>U.mutateAsync(a),tokens:i,tokenType:E.f}),w&&e.createElement(r.dJ,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:e.createElement(l.z,{variant:"secondary",startIcon:e.createElement(M.Z,null)},u({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"}))}),Y&&e.createElement(r.dJ,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})))},A=()=>e.createElement(r.O4,{permissions:R.Z.settings["transfer-tokens"].main},e.createElement($,null))}}]);
